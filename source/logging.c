/***************************************************************************//**
  @file     logging.c
  @brief    Logging Thread Source File
  @author   Grupo 4
 ******************************************************************************/

/*******************************************************************************
 * INCLUDE HEADER FILES
 ******************************************************************************/

#include "thingspeak_interface.h"

/*******************************************************************************
 * CONSTANT AND MACRO DEFINITIONS USING #DEFINE
 ******************************************************************************/

#define FLOOR1_LSB		1
#define FLOOR2_LSB		3
#define FLOOR3_LSB		5

/*******************************************************************************
 * ENUMERATIONS AND STRUCTURES AND TYPEDEFS
 ******************************************************************************/



/*******************************************************************************
 * VARIABLES WITH GLOBAL SCOPE
 ******************************************************************************/

/*******************************************************************************
 * FUNCTION PROTOTYPES FOR PRIVATE FUNCTIONS WITH FILE LEVEL SCOPE
 ******************************************************************************/


/*******************************************************************************
 * ROM CONST VARIABLES WITH FILE LEVEL SCOPE
 ******************************************************************************/

/*******************************************************************************
 * STATIC VARIABLES AND CONST VARIABLES WITH FILE LEVEL SCOPE
 ******************************************************************************/

static uint8_t occupancy[GW_DATABUFFER_LEN] = {GW_COMMAND_SEND}; // F1_LSB = 1, F2_LSB = 3, F3_LSB = 5 (Little Endian)

/*******************************************************************************
 *******************************************************************************
                        GLOBAL FUNCTION DEFINITIONS
 *******************************************************************************
 ******************************************************************************/

void logging_init(void)
{
  thingspeak_init();
}

void notify_ingress(uint8_t floor)
{
	occupancy[FLOOR1_LSB + 2*(floor-1)]++;
	thingspeak_tx(occupancy, GW_DATABUFFER_LEN);
}

/*******************************************************************************
 *******************************************************************************
                        LOCAL FUNCTION DEFINITIONS
 *******************************************************************************
 ******************************************************************************/


/******************************************************************************/
